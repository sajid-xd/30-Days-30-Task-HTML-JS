<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>CRUD Application</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
      <style>
        header {
         text-align: center;
         padding: 20px
         }
      </style>
   </head>
   <body>
    <header>
        <h3>Task#14 CRUD Application with Image <br> Team-Code bridge</h3>
     </header>
      <div class="container">
         <h1 class="mt-5 mb-4">CRUD Application</h1>
         <form id="recordForm">
            <input type="text" class="form-control mb-3" id="name" placeholder="Name" required>
            <input type="file" class="form-control mb-3" id="image" accept="image/*" required>
            <button type="submit" class="btn btn-primary">Add Record</button>
         </form>
         <div id="records" class="mt-4"></div>
      </div>
      <script>

        // Function to handle form submission

         const recordForm = document.getElementById('recordForm');
         const recordsDiv = document.getElementById('records');
         
         recordForm.addEventListener('submit', e => {
             e.preventDefault();
             const name = document.getElementById('name').value;
             const image = document.getElementById('image').files[0];
             if (!name || !image) return alert('Please fill out all fields');

         //  Unique ID for each record

             const record = { id: Date.now(), name, imageUrl: URL.createObjectURL(image) };
             let records = JSON.parse(sessionStorage.getItem('records')) || [];
             records.push(record);
             sessionStorage.setItem('records', JSON.stringify(records));
             displayRecords();
             recordForm.reset();
         });

         //  Function to display records

         function displayRecords() {
             const records = JSON.parse(sessionStorage.getItem('records')) || [];
             recordsDiv.innerHTML = '';
         
             records.forEach(record => {
                 const div = document.createElement('div');
                 div.className = 'card mb-3';
                 div.innerHTML = `
                     <div class="row g-0">
                         <div class="col-md-4"><img src="${record.imageUrl}" alt="${record.name}" class="img-fluid rounded-start" style="max-width: 100%;"></div>
                         <div class="col-md-8">
                             <div class="card-body">
                                 <h5 class="card-title">${record.name}</h5>
                                 <button class="btn btn-danger" onclick="deleteRecord(${record.id})">Delete</button>
                             </div>
                         </div>
                     </div>`;
                 recordsDiv.appendChild(div);
             });
         }

         //  Function to delete a record

         function deleteRecord(id) {
             let records = JSON.parse(sessionStorage.getItem('records')) || [];
             records = records.filter(record => record.id !== id);
             sessionStorage.setItem('records', JSON.stringify(records));
             displayRecords();
         }
         
         displayRecords();
      </script>
   </body>
</html>